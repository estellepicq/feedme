"use strict";var contactFormContainer=document.getElementById("contactFormContainer"),contactBtn=document.getElementById("contactBtn"),nameInput=document.getElementById("name"),emailInput=document.getElementById("email"),messageInput=document.getElementById("message"),errorMessage=document.getElementById("errorMessage"),successMessage=document.getElementById("successMessage");function setBtnState(){contactBtn.disabled=!(nameInput.value&&emailInput.value&&messageInput.value&&Ch.isEmail(emailInput.value))}function sendMail(e){contactBtn.disabled=!0,Aias.HTTP.POST("/mail/send","json",e).then(function(e){e.success?(contactFormContainer.style.display="none",successMessage.style.display="block"):errorMessage.style.display="block"}).catch(function(e){errorMessage.style.display="block"})}nameInput.addEventListener("keyup",function(){setBtnState()}),emailInput.addEventListener("keyup",function(){setBtnState()}),messageInput.addEventListener("keyup",function(){setBtnState()}),contactBtn.addEventListener("click",function(){sendMail({name:nameInput.value,email:emailInput.value,message:messageInput.value,from:"[www.feedinggood.com]"})});
"use strict";var searchSection=document.getElementById("search"),listElt=document.getElementById("list"),filteredListElt=document.getElementById("filteredList"),searchInput=document.getElementById("searchInput"),noFoodMessage=document.getElementById("noFoodMessage");if(searchInput){var foodItems=[];getFoodItems(),searchInput.addEventListener("keyup",function(){var e=searchInput.value;foodItems.forEach(function(t,o){var a=document.getElementById("item_"+o);searchInput.value?(searchSection.classList.add("filtering"),t.name.toLowerCase().includes(e.toLowerCase())?a.classList.contains("displayed")||a.classList.add("displayed"):a.classList.remove("displayed")):(searchSection.classList.remove("filtering"),a.classList.remove("displayed"))})})}function getFoodItems(){Aias.HTTP.GET("http://nutrimetrics.feedinggood.fr/food?fodmaps=1").then(function(e){e&&e.length?(foodItems=Ch.isJson(e)?JSON.parse(e):e,console.log(foodItems),displayList(foodItems),displayFilteredList(foodItems)):displayNoFoodMessage("Etrange, aucun aliment trouvé.")}).catch(function(e){console.log(e),displayNoFoodMessage("Oups, erreur dans la récupération des aliments.")})}function displayList(e){e.forEach(function(e){var t=document.createElement("div");t.innerHTML=createFoodItemTemplate(e),t.setAttribute("class","item");var o=e.fodmaps_category.toLowerCase().replace(/ /g,""),a=document.getElementById(o);if(!a){(a=document.createElement("div")).id=o,a.setAttribute("class","category"),listElt.append(a);var n=document.createElement("h4");n.textContent=e.fodmaps_category,a.append(n);var s=document.createElement("div");s.id=o+"_low",a.appendChild(s);var d=document.createElement("h5");d.textContent="Pauvres en FODMAPs",s.appendChild(d);var i=document.createElement("div");i.id=o+"_high",a.appendChild(i);var c=document.createElement("h5");c.textContent="Riches en FODMAPs",i.appendChild(c)}document.getElementById(o+"_"+e.fodmaps_indicator).appendChild(t)})}function displayFilteredList(e){e.forEach(function(e,t){var o=document.createElement("div");o.innerHTML=createFoodItemTemplate(e),o.setAttribute("class","filtered-item"),o.id="item_"+t,filteredListElt.appendChild(o)})}function createFoodItemTemplate(e){var t=e.fodmaps_cutoff?" - "+e.fodmaps_cutoff+" max":"";return("low"===e.fodmaps_indicator?'<div class="indicator low"></div>':'<div class="indicator high"></div>')+e.name+t}function displayNoFoodMessage(e){noFoodMessage.textContent=e,noFoodMessage.style.display="block"}
"use strict";function watchSigninForm(e){var n=document.getElementById(e+"SigninFormContainer"),t=document.getElementById(e+"SigninBtn"),i=document.getElementById(e+"SigninEmail"),s=document.getElementById(e+"SigninErrorMessage"),c=document.getElementById(e+"SigninSuccessMessage");n&&(i.addEventListener("keyup",function(){setBtnState(t,i.value)}),t.addEventListener("click",function(){var e=t.getAttribute("data-requiredDoc");signIn(i.value,e,t,n,s,c)}))}function setBtnState(e,n){e.disabled=!n||!Ch.isEmail(n)}function signIn(e,n,t,i,s,c){t.disabled=!0,Aias.HTTP.POST("/signin","json",{email:e,requiredDoc:n}).then(function(e){e.success?(i.style.display="none",c.style.display="block"):s.style.display="block"}).catch(function(e){s.style.display="block",t.disabled=!1})}watchSigninForm("foodList"),watchSigninForm("fodmapsRecipes");